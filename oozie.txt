<workflow-app name="SOW_score_workflow"  xmlns="uri:oozie:workflow:0.4"> <start to="score_calculation" />     <action name="score_calculation">  <ssh xmlns="uri:oozie:ssh-action:0.1">   <host>localhost</host>   <command>${score_script_dir}</command>   <args>${python_source_final_score_dir}/score_shareofwallet.py</args>   <args>${job_properties_path}</args>   <args>workflow_id=${wf:id()}</args>  </ssh>  <ok to="fs_makeScoreDir" />  <error to="kill" /> </action>  <action name="fs_makeScoreDir">  <fs>   <mkdir path="${wf:conf('score_csv_dir')}"/>  </fs>  <ok to="ssh_prepareScoreForLoad" />  <error to="kill" /> </action>  <action name="ssh_prepareScoreForLoad">  <ssh xmlns="uri:oozie:ssh-action:0.2">   <host>localhost</host>   <command>${prepare_score_script_dir}</command>   <arg>${data_item_dir}/${wf:id()}/score_sow/</arg>   <arg>${score_header}</arg>   <arg>${score_type_version}</arg>   <arg>${local_csv_dir}</arg>   <arg>${score_csv_dir}</arg>  </ssh>  <ok to="ssh_check_if_score_exists" />  <error to="kill" /> </action>
 <action name="ssh_check_if_score_exists">    <ssh xmlns="uri:oozie:ssh-action:0.1">   <!--  checks wether score csv exists or not -->   <host>localhost</host>   <command>${deploy_script_dir}/check_for_new_score.ksh</command>   <args>${score_csv_dir}</args>   <capture-output />  </ssh>  <ok to="ssh_check_records_of_csv_file" />  <error to="kill" /> </action>
 <action name="ssh_check_records_of_csv_file">    <ssh xmlns="uri:oozie:ssh-action:0.1">   <!--  checks wether score csv exists or not -->   <host>localhost</host>   <command>${deploy_script_dir}/check_for_records.ksh</command>   <args>${score_csv_dir}</args>   <capture-output />  </ssh>  <ok to="decision_continueIfScoreExists" />  <error to="kill" /> </action>  <decision name="decision_continueIfScoreExists">  <switch>   <case to="kill">${wf:actionData('ssh_check_records_of_csv_file')['score_path_records'] eq '0'}</case>   <default to="fs_cleanup_files" />   </switch> </decision>
    <action name="fs_cleanup_files">  <fs>   <delete path="${data_item_dir}/${wf:id()}" />  </fs>  <ok to="ssh_copy_score_output_s3" />  <error to="kill" /> </action> <action name="ssh_copy_score_output_s3">    <ssh xmlns="uri:oozie:ssh-action:0.1">   <!--  exports score csv file to s3  -->   <host>localhost</host>   <command>${deploy_script_dir}/output_results_to_s3.sh</command>   <args>${score_csv_dir}</args>   <args>${aws_s3_score_location}</args>   <capture-output />  </ssh>  <ok to="end" />  <error to="kill" /> </action>  
 <kill name="kill">  <message>Action failed, error   message[${wf:errorMessage(wf:lastErrorNode())}]</message> </kill>
 <end name="end" /></workflow-app>
